<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–§–æ—Ä—É–º</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#0f111a;color:#eee}
header{background:#151826;padding:15px;display:flex;justify-content:space-between}
button{background:#ff6a00;border:none;color:#fff;padding:8px 12px;border-radius:5px;cursor:pointer}
.container{max-width:900px;margin:20px auto;background:#151826;padding:15px;border-radius:10px}
input,textarea{width:100%;background:#1f2236;border:none;color:#fff;padding:8px;border-radius:5px;margin:5px 0}
.topic{background:#1f2236;padding:10px;margin:5px 0;border-radius:5px;cursor:pointer}
</style>
</head>
<body>

<header>
  <b>–§–æ—Ä—É–º</b>
  <span id="userNick"></span>
</header>

<div class="container" id="auth">
  <h3>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h3>
  <input id="nickInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω—ñ–∫">
  <button id="regBtn">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
</div>

<div class="container" id="forum" style="display:none">
  <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–º—É</h3>
  <input id="titleInput" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
  <textarea id="textInput" placeholder="–¢–µ–∫—Å—Ç"></textarea>
  <button id="createBtn">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
  <hr>
  <div id="topics"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// üî¥ –í–°–¢–ê–í –°–í–Ü–ô CONFIG
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
  projectId: "YOUR_PROJECT"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ---------- –ê–í–¢–û-–õ–û–ì–Ü–ù ----------
let currentUser = localStorage.getItem("forum_user");

if(currentUser){
  document.getElementById("auth").style.display="none";
  document.getElementById("forum").style.display="block";
  document.getElementById("userNick").innerText = currentUser;
}

// ---------- –†–ï–Ñ–°–¢–†–ê–¶–Ü–Ø ----------
document.getElementById("regBtn").onclick = function(){
  const nick = document.getElementById("nickInput").value.trim();

  if(nick.length < 3){
    alert("–ù—ñ–∫ –º—ñ–Ω—ñ–º—É–º 3 —Å–∏–º–≤–æ–ª–∏");
    return;
  }

  db.ref("users/" + nick).get().then(snap=>{
    if(snap.exists()){
      alert("–¶–µ–π –Ω—ñ–∫ –≤–∂–µ –∑–∞–π–Ω—è—Ç–∏–π");
      return;
    }

    db.ref("users/" + nick).set({
      created: Date.now()
    });

    localStorage.setItem("forum_user", nick);
    location.reload();
  }).catch(err=>{
    alert("–ü–æ–º–∏–ª–∫–∞ Firebase");
    console.error(err);
  });
};

// ---------- –°–¢–í–û–†–ï–ù–ù–Ø –¢–ï–ú–ò ----------
document.getElementById("createBtn").onclick = function(){
  const title = titleInput.value.trim();
  const text = textInput.value.trim();

  if(!title || !text) return alert("–ó–∞–ø–æ–≤–Ω–∏ –≤—Å–µ");

  db.ref("topics").push({
    title,
    text,
    author: currentUser,
    time: Date.now()
  });

  titleInput.value="";
  textInput.value="";
};

// ---------- REALTIME –¢–ï–ú–ò ----------
db.ref("topics").on("value", snap=>{
  topics.innerHTML="";
  snap.forEach(t=>{
    const d=document.createElement("div");
    d.className="topic";
    d.innerHTML=`<b>${t.val().title}</b><br><small>${t.val().author}</small>`;
    topics.prepend(d);
  });
});
</script>

</body>
</html>
